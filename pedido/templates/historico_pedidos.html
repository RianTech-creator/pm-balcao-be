{% extends "base.html" %}

{% block title %}
Histórico de Pedidos
{% endblock %}

{% block header %}
<h1>Histórico de Pedidos</h1>
{% endblock %}

{% block main %}
<section>
    <h2>Seu Histórico de Pedidos, {{ user.get_full_name|default:user.username }}</h2>

    {% if pedidos %}
        <ul>
            {% for pedido in pedidos %}
                <li>
                    <strong>Pedido #{{ pedido.id }}</strong> - Data: {{ pedido.data_pedido }} - Total: R$ {{ pedido.total|floatformat:2 }}
                    <ul>
                        {% for item in pedido.itens.all %}
                            <li>
                                {{ item.produto.nome }} - Quantidade: {{ item.quantidade }} - Subtotal: R$ {{ item.subtotal|floatformat:2 }}
                            </li>
                        {% endfor %}
                    </ul>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Você ainda não fez nenhum pedido.</p>
    {% endif %}

    <br>
    <a href="{% url 'painel_usuario' %}">Voltar ao Painel</a>
</section>
{% endblock %}

{% block footer %}
<p>© 2025 Cantina do Aluno</p>
{% endblock %}